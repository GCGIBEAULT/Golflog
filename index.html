<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Golf Log — Mobile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="container">
    <h1>Golf Log</h1>

    <form id="roundForm" class="single-column" onsubmit="saveRound(event)">
      <!-- Date and Course stacked -->
      <div class="row">
        <label for="date">Date</label>
        <input id="date" name="date" type="text" placeholder="mm/dd/yyyy" inputmode="numeric" />

        <label for="course">Course Name</label>
        <input id="course" name="course" type="text" placeholder="Course Name" />
      </div>

      <!-- Score and Slope stacked -->
      <div class="row">
        <label for="score">Score</label>
        <input id="score" name="score" type="number" inputmode="numeric" placeholder="Score" />

        <label for="slope">Slope</label>
        <input id="slope" name="slope" type="number" inputmode="numeric" placeholder="Slope" />
      </div>

      <!-- Handicap -->
      <div class="row">
        <label for="handicap">Handicap</label>
        <input id="handicap" name="handicap" type="number" inputmode="numeric" placeholder="Handicap" />
      </div>

      <!-- Notes -->
      <div class="row">
        <label for="notes">Notes</label>
        <textarea id="notes" name="notes" placeholder="Add any comments or conditions"></textarea>
      </div>

      <!-- Save button -->
      <button id="saveBtn" type="submit">Save Round</button>
    </form>

    <!-- Saved rounds -->
    <section id="savedRounds" aria-live="polite">
      <h2 class="visually-hidden">Saved Rounds</h2>
      <div id="roundList"></div>
    </section>
  </main>

  <script>
    function escapeHtml(str) {
      return String(str || '').replace(/[&<>"']/g, m => ({
        '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
      })[m]);
    }

    function loadRounds() {
      try {
        return JSON.parse(localStorage.getItem('golfRounds') || '[]');
      } catch {
        return [];
      }
    }

    function saveRounds(list) {
      localStorage.setItem('golfRounds', JSON.stringify(list));
    }

    function renderRounds() {
      const list = loadRounds();
      const container = document.getElementById('roundList');
      container.innerHTML = '';
      if (!list.length) {
        container.textContent = 'No saved rounds';
        return;
      }
      list.forEach((r, idx) => {
        const el = document.createElement('div');
        el.className = 'log-line';
        el.innerHTML = `
          <strong>${escapeHtml(r.date)}</strong> — ${escapeHtml(r.course)}<br>
          Score: ${escapeHtml(r.score)} | Slope: ${escapeHtml(r.slope)} | Handicap: ${escapeHtml(r.handicap)}
          ${r.notes ? `<div class="note">${escapeHtml(r.notes)}</div>` : ''}
          <button class="del" data-i="${idx}" type="button">Delete</button>
        `;
        container.appendChild(el);
      });
    }

    function saveRound(e) {
      e.preventDefault();
      const round = {
        date: document.getElementById('date').value.trim(),
        course: document.getElementById('course').value.trim(),
        score: document.getElementById('score').value.trim(),
        slope: document.getElementById('slope').value.trim(),
        handicap: document.getElementById('handicap').value.trim(),
        notes: document.getElementById('notes').value.trim()
      };
      if (!round.date && !round.course && !round.score) return;
      const list = loadRounds();
      list.unshift(round);
      saveRounds(list);
      renderRounds();
      document.getElementById('roundForm').reset();
    }

    document.addEventListener('click', ev => {
      const btn = ev.target.closest('button.del');
      if (!btn) return;
      const idx = Number(btn.getAttribute('data-i'));
      const list = loadRounds();
      if (Number.isFinite(idx)) {
        list.splice(idx, 1);
        saveRounds(list);
        renderRounds();
      }
    });

    renderRounds();
  </script>
</body>
</html>
