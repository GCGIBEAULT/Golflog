<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Golf Log — Mobile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Golf Log — record Date, Course, Score, Slope, Handicap and Notes." />
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Minimal page-level reset for safe mobile rendering */
    html { font-size: 20px; -webkit-text-size-adjust: 100%; box-sizing: border-box; }
    *, *::before, *::after { box-sizing: inherit; }
    body { margin: 0; padding: 1rem; font-family: -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background:#fff; color:#111; line-height:1.35; }
    h1 { font-size:1.6rem; margin:0 0 0.75rem 0; border-bottom:2px solid #0066cc; padding-bottom:0.5rem; }
    .visually-hidden { position:absolute; left:-9999px; width:1px; height:1px; overflow:hidden; }
    /* Ensure .row no longer forces flex layout */
    .row { display: block !important; width:100% !important; margin-bottom:1rem !important; box-sizing:border-box !important; }
    .row > * { display:block !important; width:100% !important; margin:0 0 .5rem 0 !important; box-sizing:border-box !important; }
  </style>
</head>
<body>
  <main id="app" class="container">
    <h1>Golf Log</h1>

    <!-- Single-column form (source order controls vertical layout) -->
    <form id="roundForm" class="single-column" onsubmit="saveRound(event)" autocomplete="off" novalidate>
      <label for="date">Date</label>
      <input id="date" name="date" type="text" placeholder="mm/dd/yyyy" inputmode="numeric" />

      <label for="course">Course Name</label>
      <input id="course" name="course" type="text" placeholder="Course Name" />

      <label for="score">Score</label>
      <input id="score" name="score" type="number" inputmode="numeric" placeholder="Score" />

      <label for="slope">Slope</label>
      <input id="slope" name="slope" type="number" inputmode="numeric" placeholder="Slope" />

      <label for="handicap">Handicap</label>
      <input id="handicap" name="handicap" type="number" inputmode="numeric" placeholder="Handicap" />

      <label for="notes">Notes</label>
      <textarea id="notes" name="notes" placeholder="Add any comments or conditions"></textarea>

      <button id="saveBtn" type="submit">Save Round</button>
    </form>

    <section id="savedRounds" aria-live="polite">
      <h2 class="visually-hidden">Saved Rounds</h2>
      <div id="roundList"></div>
    </section>
  </main>

  <script>
    (function () {
      const STORAGE_KEY = 'golfRounds';
      function escapeHtml(str) {
        return String(str || '').replace(/[&<>"']/g, function (m) {
          return ({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' })[m];
        });
      }
      function loadRounds() {
        try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); } catch (e) { return []; }
      }
      function saveRounds(list) { localStorage.setItem(STORAGE_KEY, JSON.stringify(list)); }
      function renderRounds() {
        const list = loadRounds();
        const container = document.getElementById('roundList');
        container.innerHTML = '';
        if (!list.length) { container.textContent = 'No saved rounds'; return; }
        list.forEach((r, idx) => {
          const el = document.createElement('div');
          el.className = 'log-line';
          const noteHtml = r.notes ? `<div class="note">${escapeHtml(r.notes)}</div>` : '';
          el.innerHTML = `
            <div class="entry-top">
              <strong class="date">${escapeHtml(r.date)}</strong>
              <div class="course">${escapeHtml(r.course)}</div>
            </div>
            <div class="entry-stats">
              <div class="stat">Score: ${escapeHtml(r.score)}</div>
              <div class="stat">Slope: ${escapeHtml(r.slope)}</div>
              <div class="stat">Handicap: ${escapeHtml(r.handicap)}</div>
            </div>
            ${noteHtml}
            <div class="entry-actions"><button class="del" data-i="${idx}" type="button">Delete</button></div>
          `;
          container.appendChild(el);
        });
      }
      function clearForm() { document.getElementById('roundForm').reset(); }
      window.saveRound = function (e) {
        if (e) e.preventDefault();
        const date = document.getElementById('date').value.trim();
        const course = document.getElementById('course').value.trim();
        const score = document.getElementById('score').value.trim();
        const slope = document.getElementById('slope').value.trim();
        const handicap = document.getElementById('handicap').value.trim();
        const notes = document.getElementById('notes').value.trim();
        if (!date && !course && !score) return;
        const list = loadRounds();
        list.unshift({ date, course, score, slope, handicap, notes });
        saveRounds(list);
        renderRounds();
        clearForm();
      };
      document.addEventListener('click', function (ev) {
        const del = ev.target.closest('button.del');
        if (!del) return;
        const idx = Number(del.getAttribute('data-i'));
        const list = loadRounds();
        if (Number.isFinite(idx) && idx >= 0 && idx < list.length) {
          list.splice(idx, 1);
          saveRounds(list);
          renderRounds();
        }
      });
      // initial render
      renderRounds();
    })();
  </script>
</body>
</html>
